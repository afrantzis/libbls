Import('env')

env1 = env.Clone()
env1.Append(CPPPATH = '#src')
env1['ENV']['LD_LIBRARY_PATH'] = 'build/src-release'

sources = Glob('*.c')

benchmarks = []

valgrind = int(ARGUMENTS.get('valgrind', 0))

for source in sources: 
	prog = env1.Program(source, LIBS='$libbless_name_no_lib',
		LIBPATH='#build/src-release')

	if valgrind == 1:
		cmd = env1.Command('bench_dummy_%s' % prog, prog,
			'valgrind --leak-check=full $SOURCE')
	else:
		cmd = env1.Command('bench_dummy_%s' % prog, prog, '${SOURCE.abspath}')

	benchmarks.extend(cmd)

	 
Return('benchmarks')
